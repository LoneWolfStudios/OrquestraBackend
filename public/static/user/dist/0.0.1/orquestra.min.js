/*! orquestra 2016-06-22 */
function view(a){return APP_URL+"/user/"+a}function api_v1(a){return APP_URL+"/api/v1/"+a}function attr(a,b){for(var c in b)a[c]=b[c]}var OrquestraUser=angular.module("OrquestraUser",["ui.router"]),APP_URL=$("#APP_URL").val();OrquestraUser.run([function(){}]),OrquestraUser.factory("Device",[function(){var a=new Function;return a}]),OrquestraUser.factory("User",["DeviceRepository",function(a){var b=new Function;return b.prototype.devices=function(){return a.byUser(this.id)},b}]),OrquestraUser.service("CurrentUser",["$http","$q","User",function(a,b,c){var d={},e=!1;return d.get=function(){var d=b.defer();return e?d.resolve(e):a.get(api_v1("user")).then(function(a){var b=new c(a.data.id);_.extend(b,a.data),e=b,d.resolve(e)}),d.promise},d}]),OrquestraUser.service("DeviceRepository",["$http","$q","Device",function(a,b,c){var d={};return d.byUser=function(d){var e=b.defer();return a.get(api_v1("device/byUser/"+d)).then(function(a){var b=_.map(a.data,function(a){var b=new c;return attr(b,a),b});e.resolve(b)}),e.promise},d}]),OrquestraUser.controller("DashboardIndexCtrl",["$scope",function(a){a.test="User Dashboard Index"}]),OrquestraUser.controller("DeviceDetailCtrl",["$scope",function(a){a.test="Device Detail"}]),OrquestraUser.controller("LeftNavbarCtrl",["$scope","CurrentUser",function(a,b){b.get().then(function(b){a.user=b,b.devices().then(function(b){a.devices=b})})}]),OrquestraUser.config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/"),a.state("home",{url:"/",views:{MainContent:{templateUrl:view("dashboard")}}}).state("device_detail",{url:"/device/{id}",views:{MainContent:{templateUrl:view("device/detail")}}})}]);